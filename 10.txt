MongoDB - Aggregation and Indexing: 
Design and Develop MongoDB Queries using aggregation and indexing with suitable example 
using MongoDB. 


B2- 

// Use database
use company_db

// Create collection and insert sample data
db.employees.insertMany([
    {name: "Aarya", department: "IT", salary: 50000, age: 25},
    {name: "Krushna", department: "HR", salary: 45000, age: 30},
    {name: "Yash", department: "IT", salary: 60000, age: 28},
    {name: "Rohit", department: "Finance", salary: 55000, age: 35},
    {name: "Priya", department: "IT", salary: 52000, age: 26}
])

// ===== AGGREGATION OPERATIONS =====

// 1. Group by department and calculate average salary
db.employees.aggregate([
    {$group: {_id: "$department", avgSalary: {$avg: "$salary"}}}
])

// 2. Find total employees and average salary in each department
db.employees.aggregate([
    {$group: {
        _id: "$department", 
        totalEmployees: {$sum: 1},
        avgSalary: {$avg: "$salary"},
        maxSalary: {$max: "$salary"}
    }}
])

// 3. Filter employees with salary > 50000 and group by department
db.employees.aggregate([
    {$match: {salary: {$gt: 50000}}},
    {$group: {_id: "$department", count: {$sum: 1}}}
])

// ===== INDEXING OPERATIONS =====

// 1. Create index on department field
db.employees.createIndex({department: 1})

// 2. Create index on salary field
db.employees.createIndex({salary: -1})

// 3. Create compound index on department and salary
db.employees.createIndex({department: 1, salary: -1})

// 4. Show all indexes
db.employees.getIndexes()

// 5. Check if index is used (explain query)
db.employees.find({department: "IT"}).explain("executionStats")

// 6. Drop an index
db.employees.dropIndex("department_1")