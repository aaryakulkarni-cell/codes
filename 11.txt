 MongoDB - Map reduces operations: 
Implement Map reduces operation with suitable example using MongoDB. 


B3- 


// === COMPLETE MAP-REDUCE PROGRAM ===

// 1. Create database and data
use company_sales
db.sales.insertMany([
    {customer: "Aarya", product: "Laptop", amount: 50000},
    {customer: "Krushna", product: "Mouse", amount: 1500},
    {customer: "Yash", product: "Laptop", amount: 45000},
    {customer: "Rohit", product: "Keyboard", amount: 3000},
    {customer: "Priya", product: "Mouse", amount: 1200},
    {customer: "Aarya", product: "Mouse", amount: 1500}
])

// 2. Map function - process each document
var mapFunction = function() {
    emit(this.product, this.amount);
};

// 3. Reduce function - process each group  
var reduceFunction = function(key, values) {
    return Array.sum(values);
};

// 4. Execute Map-Reduce
db.sales.mapReduce(
    mapFunction,
    reduceFunction, 
    { out: "product_totals" }
);

// 5. View results
db.product_totals.find()