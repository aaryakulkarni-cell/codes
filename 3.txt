 Unnamed PL/SQL code block: Use of Control structure and Exception handling is 
mandatory. 
Suggested Problem statement: 
Consider Tables:  
1. Borrower(Roll_no, Name, DateofIssue, NameofBook, Status)  
2. Fine(Roll_no,Date,Amt) 
Note: Instructor will frame the problem statement for writing PL/SQL block in line with above 
statement. 
5.  Named PL/SQL Block: PL/SQL Stored Procedure and Stored Function. 
Write a Stored Procedure namely proc_Grade for the categorization of student. If marks scored by 
students in examination is <=1500 and marks>=990 then student will be placed in distinction 
category if marks scored are between 989 and 900 category is first class, if marks 899 and 825 
category is Higher Second Class. 
 Accept Roll_no and NameofBook from user.   
 Check the number of days (from date of issue). 
 If days are between 15 to 30 then fine amount will be Rs 5per day. 
 If no. of days>30, per day fine will be Rs 50 per day and for days less than 30, Rs. 5 per 
day.   
 After submitting the book, status will change from I to R. 
 If condition of fine is true, then details will be stored into fine table. 
 Also handles the exception by named exception handler or user define exception handler.


Practical 3- 


-- Create database and tables
CREATE DATABASE Prac4;
USE Prac4;

CREATE TABLE Borrower (
  Roll_no INT,
  Name VARCHAR(100),
  DOI DATE,
  NameofBook VARCHAR(100),
  Status CHAR(1)
);

CREATE TABLE Fine (
  Roll_no INT,
  sDate DATE,
  Amt DECIMAL(10,2)
);

-- Insert sample data
INSERT INTO Borrower (Roll_no, Name, DOI, NameofBook, Status)
VALUES (101, 'Alice', '2025-08-20', 'Learn SQL', 'I');

INSERT INTO Borrower (Roll_no, Name, DOI, NameofBook, Status)
VALUES (102, 'Bob', '2025-09-01', 'Database Systems', 'I');

-- Show initial data
SELECT * FROM Borrower;

-- Create stored procedure
DROP PROCEDURE IF EXISTS p_fine;

DELIMITER //

CREATE PROCEDURE p_fine(IN rno INT, IN bname VARCHAR(20))
BEGIN
DECLARE d1 DATE;
DECLARE daycnt INT;
DECLARE fine_amt INT;

SELECT DOI INTO d1
FROM Borrower
WHERE Roll_no = rno AND NameofBook = bname
LIMIT 1;

SELECT DATEDIFF(NOW(), d1) INTO daycnt;

IF (daycnt >= 15 AND daycnt <= 30) THEN
    SET fine_amt = daycnt * 5;
    INSERT INTO Fine(Roll_no, sDate, Amt) VALUES (rno, NOW(), fine_amt);
    UPDATE Borrower SET Status = 'R' WHERE Roll_no = rno;
ELSEIF (daycnt > 30) THEN
    SET fine_amt = daycnt * 50;
    INSERT INTO Fine(Roll_no, sDate, Amt) VALUES (rno, NOW(), fine_amt);
    UPDATE Borrower SET Status = 'R' WHERE Roll_no = rno;
ELSE
    UPDATE Borrower SET Status = 'R' WHERE Roll_no = rno;
END IF;
END;
//

DELIMITER ;

-- Test the procedure
CALL p_fine(101, "Learn SQL");

-- Show results
SELECT * FROM Borrower;
SELECT * FROM Fine;